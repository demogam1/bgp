Router RR 

#!/bin/bash
# Ce script configure les interfaces réseau et les protocoles de routage sur un routeur.

# Entrez dans vtysh pour configurer FRR.
vtysh << EOT
config t
# Désactiver le routage IPv6.
no ipv6 forwarding

# Configurer l'interface eth0 avec l'adresse IP spécifiée.
interface eth0
 ip address 10.1.1.1/30
!

# Configurer l'interface eth1 avec l'adresse IP spécifiée.
interface eth1
 ip address 10.1.1.5/30
!

# Configurer l'interface eth2 avec l'adresse IP spécifiée.
interface eth2
 ip address 10.1.1.9/30
!

# Configurer l'interface de loopback avec l'adresse IP spécifiée.
interface lo
 ip address 1.1.1.1/32
!

# Configurer le protocole de routage BGP avec l'AS spécifié.
router bgp 1
 # Créer et configurer un groupe de pairs iBGP.
 neighbor ibgp peer-group
 neighbor ibgp remote-as 1
 neighbor ibgp update-source lo
 # Configurer l'écoute BGP sur une plage d'adresses pour le groupe de pairs iBGP.
 bgp listen range 1.1.1.0/24 peer-group ibgp
!
 # Activer la famille d'adresses L2VPN EVPN pour le groupe de pairs iBGP.
 address-family l2vpn evpn
  neighbor ibgp activate
  # Déclarer les voisins iBGP comme clients de réflecteur de routes.
  neighbor ibgp route-reflector-client
 exit-address-family
!

# Configurer le protocole de routage OSPF pour annoncer tous les réseaux.
router ospf
 network 0.0.0.0/0 area 0
!

# Configuration de la ligne vty (accès au terminal virtuel).
line vty
!
EOT

Router 2

#!/bin/bash
# Début du script, indique que le script doit être exécuté avec Bash.

# Création d'un pont réseau nommé br0.
ip link add br0 type bridge
# Activation du pont réseau br0.
ip link set dev br0 up
# Ajout d'une interface VXLAN nommée vxlan10 avec l'identifiant 10 et le port de destination 4789.
ip link add vxlan10 type vxlan id 10 dstport 4789
# Activation de l'interface vxlan10.
ip link set vxlan10 up
# Attribution de vxlan10 au pont br0.
ip link set vxlan10 master br0
# Attribution de l'interface eth0 au pont br0.
ip link set eth1 master br0

# Entrez dans vtysh pour configurer FRR.
vtysh << EOT
conf t
# Désactiver le routage IPv6.
no ipv6 forwarding
interface eth0
# Attribuer une adresse IP à l'interface eth2 et définir son appartenance à la zone OSPF 0.
 ip address 10.1.1.2/30
 ip ospf area 0
!
interface lo
# Attribuer une adresse IP à l'interface de loopback et définir son appartenance à la zone OSPF 0.
 ip address 1.1.1.2/32
 ip ospf area 0
!
router bgp 1
# Configuration du voisin BGP avec l'adresse 1.1.1.1 et le même AS 1.
 neighbor 1.1.1.1 remote-as 1
# Définir l'interface de loopback comme source pour les mises à jour BGP.
 neighbor 1.1.1.1 update-source lo
 !
 address-family l2vpn evpn
  # Activer le voisin BGP pour la famille d'adresses L2VPN EVPN.
  neighbor 1.1.1.1 activate
  # Annoncer tous les VNI (Virtual Network Identifier).
  advertise-all-vni
 exit-address-family
!
router ospf
# Sortie de la configuration OSPF, pas d'autres commandes n'ont été fournies.
end
# Enregistrer la configuration dans la configuration permanente de FRR.
write
EOT

Router 3 

#!/bin/bash
# Début du script, indique que le script doit être exécuté avec Bash.

# Création d'un pont réseau nommé br0.
ip link add br0 type bridge
# Activation du pont réseau br0.
ip link set dev br0 up
# Ajout d'une interface VXLAN nommée vxlan10 avec l'identifiant 10 et le port de destination 4789.
ip link add vxlan10 type vxlan id 10 dstport 4789
# Activation de l'interface vxlan10.
ip link set vxlan10 up
# Attribution de vxlan10 au pont br0.
ip link set vxlan10 master br0
# Attribution de l'interface eth0 au pont br0.
ip link set eth0 master br0

# Entrez dans vtysh pour configurer FRR.
vtysh << EOT
conf t
# Désactiver le routage IPv6.
no ipv6 forwarding
interface eth1
# Attribuer une adresse IP à l'interface eth2 et définir son appartenance à la zone OSPF 0.
 ip address 10.1.1.6/30
 ip ospf area 0
!
interface lo
# Attribuer une adresse IP à l'interface de loopback et définir son appartenance à la zone OSPF 0.
 ip address 1.1.1.3/32
 ip ospf area 0
!
router bgp 1
# Configuration du voisin BGP avec l'adresse 1.1.1.1 et le même AS 1.
 neighbor 1.1.1.1 remote-as 1
# Définir l'interface de loopback comme source pour les mises à jour BGP.
 neighbor 1.1.1.1 update-source lo
 !
 address-family l2vpn evpn
  # Activer le voisin BGP pour la famille d'adresses L2VPN EVPN.
  neighbor 1.1.1.1 activate
  # Annoncer tous les VNI (Virtual Network Identifier).
  advertise-all-vni
 exit-address-family
!
router ospf
# Sortie de la configuration OSPF, pas d'autres commandes n'ont été fournies.
end
# Enregistrer la configuration dans la configuration permanente de FRR.
write
EOT

Router 4

#!/bin/bash
# Début du script, indique que le script doit être exécuté avec Bash.

# Création d'un pont réseau nommé br0.
ip link add br0 type bridge
# Activation du pont réseau br0.
ip link set dev br0 up
# Ajout d'une interface VXLAN nommée vxlan10 avec l'identifiant 10 et le port de destination 4789.
ip link add vxlan10 type vxlan id 10 dstport 4789
# Activation de l'interface vxlan10.
ip link set vxlan10 up
# Attribution de vxlan10 au pont br0.
ip link set vxlan10 master br0
# Attribution de l'interface eth0 au pont br0.
ip link set eth0 master br0

# Entrez dans vtysh pour configurer FRR.
vtysh << EOT
conf t
# Désactiver le routage IPv6.
no ipv6 forwarding
interface eth2
# Attribuer une adresse IP à l'interface eth2 et définir son appartenance à la zone OSPF 0.
 ip address 10.1.1.10/30
 ip ospf area 0
!
interface lo
# Attribuer une adresse IP à l'interface de loopback et définir son appartenance à la zone OSPF 0.
 ip address 1.1.1.4/32
 ip ospf area 0
!
router bgp 1
# Configuration du voisin BGP avec l'adresse 1.1.1.1 et le même AS 1.
 neighbor 1.1.1.1 remote-as 1
# Définir l'interface de loopback comme source pour les mises à jour BGP.
 neighbor 1.1.1.1 update-source lo
 !
 address-family l2vpn evpn
  # Activer le voisin BGP pour la famille d'adresses L2VPN EVPN.
  neighbor 1.1.1.1 activate
  # Annoncer tous les VNI (Virtual Network Identifier).
  advertise-all-vni
 exit-address-family
!
router ospf
# Sortie de la configuration OSPF, pas d'autres commandes n'ont été fournies.
end
# Enregistrer la configuration dans la configuration permanente de FRR.
write
EOT
